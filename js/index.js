"use strict";class TennisPlayer{constructor(e,t,n,a,i,r){this.name=e,this.birthday=t,this.birthplace=n,this.citizenship=a,this.height=i,this.outfitter=r,this.statistics=new Statistics,this.ranking=new Ranking}toString(){return this.name+", "+this.birthday+", "+this.birthplace+", "+this.citizenship+", "+this.height+", "+this.outfitter}toKeyValuePair(){let e=new Map;return e.set("Name",this.name),e.set("Date of Birth",this.birthday),e.set("Place of birth",this.birthplace),e.set("Age",isNaN(parseInt((new Date).getFullYear()-new Date(this.birthday).getFullYear()))?"-":parseInt((new Date).getFullYear()-new Date(this.birthday).getFullYear())),e.set("Height (m)",this.height),e.set("Citizenship",this.citizenship),e.set("Outfitter",this.outfitter),e}}class Statistics{constructor(){void 0===localStorage.singlesServiceRecord?this.singlesServiceRecord=this.initializeSinglesService():this.singlesServiceRecord=new Map(JSON.parse(localStorage.singlesServiceRecord)),void 0===localStorage.singlesReturnRecord?this.singlesReturnRecord=this.initializeSinglesReturn():this.singlesReturnRecord=new Map(JSON.parse(localStorage.singlesReturnRecord)),this.complementaryService=new Map,this.complementaryReturn=new Map,this.setComplementaryServiceFields(),this.setComplementaryReturnFields()}setComplementaryServiceFields(){this.complementaryService.set("1st Serve Points Won (%)","1st Serve Points Lost (%)"),this.complementaryService.set("2nd Serve Points Won (%)","2nd Serve Points Lost (%)"),this.complementaryService.set("Break Points Saved (%)","Break Points Lost (%)"),this.complementaryService.set("Service Games Won (%)","Service Games Lost (%)"),this.complementaryService.set("Total Service Points Won (%)","Total Service Points Lost (%)")}setComplementaryReturnFields(){this.complementaryReturn.set("1st Serve Return Points Won (%)","1st Serve Return Points Lost (%)"),this.complementaryReturn.set("2nd Serve Return Points Won (%)","2nd Serve Return Points Lost (%)"),this.complementaryReturn.set("Break Points Converted (%)","Break Points Not Converted (%)"),this.complementaryReturn.set("Return Games Won (%)","Return Games Lost (%)"),this.complementaryReturn.set("Return Points Won (%)","Return Points Lost (%)")}initializeSinglesService(){var e=new Map;return e.set("Aces",0),e.set("Double Faults",0),e.set("1st Serve (%)",0),e.set("1st Serve Points Won (%)",0),e.set("1st Serve Points Lost (%)",0),e.set("2nd Serve Points Won (%)",0),e.set("2nd Serve Points Lost (%)",0),e.set("Break Points Faced",0),e.set("Break Points Saved (%)",0),e.set("Break Points Lost (%)",0),e.set("Break Points Saved (Cardinal)",0),e.set("Break Points Lost (Cardinal)",0),e.set("Service Games Played",0),e.set("Service Games Won (%)",0),e.set("Service Games Lost (%)",0),e.set("Service Games Won (Cardinal)",0),e.set("Service Games Lost (Cardinal)",0),e.set("Total Service Points Won (%)",0),e.set("Total Service Points Lost (%)",0),e}initializeSinglesReturn(){var e=new Map;return e.set("1st Serve Return Points Won (%)",0),e.set("1st Serve Return Points Lost (%)",0),e.set("2nd Serve Return Points Won (%)",0),e.set("2nd Serve Return Points Lost (%)",0),e.set("Break Points Opportunities",0),e.set("Break Points Converted (%)",0),e.set("Break Points Not Converted (%)",0),e.set("Return Games Played",0),e.set("Return Games Won (%)",0),e.set("Return Games Lost (%)",0),e.set("Return Points Won (%)",0),e.set("Return Points Lost (%)",0),e.set("Total Points Won (%)",0),e}}class Ranking{constructor(e,t,n){arguments.length?(this.high=e,this.low=t,this.end=n):(null===localStorage.getItem("high")?this.high=[{YYYY:0}]:this.high=JSON.parse(localStorage.getItem("high")),null===localStorage.getItem("low")?this.low=[{YYYY:0}]:this.low=JSON.parse(localStorage.getItem("low")),null===localStorage.getItem("end")?this.end=[{YYYY:0}]:this.end=JSON.parse(localStorage.getItem("end")))}}var player=initializePlayer();function initializePlayer(){const e=["Enter Name Here","MM/DD/YYYY","Enter Birthplace","Enter Citizenship","Enter Height","Enter Outfitter"];if(0===localStorage.length)var t=new TennisPlayer(e[0],e[1],e[2],e[3],e[4],e[5]);else{let n=null===localStorage.getItem("Name")?e[0]:localStorage.getItem("Name"),a=null===localStorage.getItem("Date of Birth")?e[1]:localStorage.getItem("Date of Birth"),i=null===localStorage.getItem("Place of birth")?e[2]:localStorage.getItem("Place of birth"),r=null===localStorage.getItem("Citizenship")?e[3]:localStorage.getItem("Citizenship"),s=null===localStorage.getItem("Height (m)")||isNaN(localStorage.getItem("Height (m)"))?e[4]:localStorage.getItem("Height (m)"),o=null===localStorage.getItem("Outfitter")?e[5]:localStorage.getItem("Outfitter");t=new TennisPlayer(n,a,i,r,s,o)}return t}function displayPlayerInfo(){var e=createSection("Basic Information","info","./images/icons/info.svg","info-icon");let[t,n]=createTable(player.toKeyValuePair(),"info-table","");e.appendChild(t),document.getElementById("cover").parentNode.insertBefore(e,document.getElementById("cover").nextSibling)}function displayPlayerStatistics(){var e=createSection("Statistics","stats","./images/icons/stats.svg","stats-icon"),t=document.createElement("div");t.id="player-stats",t.classList.add("stats-table-wrapper");let[n,a]=createTable(player.statistics.singlesServiceRecord,"stats-table-singles-service","Singles Service Record");t.appendChild(a),t.appendChild(n);let[i,r]=createTable(player.statistics.singlesReturnRecord,"stats-table-singles-return","Singles Return Record");t.appendChild(r),t.appendChild(i),e.appendChild(t),document.getElementById("info").parentNode.insertBefore(e,document.getElementById("info").nextSibling)}function displayPlayerRanking(){var e=createSection("ATP Ranking by Year","ranking","./images/icons/ranking.svg","ranking-icon"),t=document.createElement("div");t.id="player-ranking";let[n,a]=createRankingTable("ranking-by-year-table","General"),i=document.createElement("img");i.id="add-row-img",i.alt="add",i.src="./images/icons/plus.svg",i.addEventListener("click",insertRankingRow),i.addEventListener("click",saveRankingToLocalStorage),i.addEventListener("click",loadRankingChart),i.addEventListener("click",addEventListenersToTds),t.appendChild(a),t.appendChild(n),t.appendChild(i),e.appendChild(t),document.getElementById("stats").parentNode.insertBefore(e,document.getElementById("stats").nextSibling)}function createSection(e,t,n,a){var i=document.createElement("section");i.id=t;var r=document.createElement("div"),s=document.createElement("img");s.src=n,s.classList.add("category-icon"),s.alt=a,r.appendChild(s);var o=document.createElement("h2");return o.textContent=e,r.appendChild(o),i.appendChild(r),i}function createTable(e,t,n){var a=document.createElement("table");a.id=t;var i=document.createElement("div"),r=document.createElement("h3");for(var[s,o]of(r.textContent=n,i.appendChild(r),e)){var l=document.createElement("tr"),d=document.createElement("th"),c=document.createElement("td");c.id=s,d.appendChild(document.createTextNode(s)),c.appendChild(document.createTextNode(o)),l.appendChild(d),l.appendChild(c),a.appendChild(l)}return[a,i]}function createRankingTable(e,t){var n=["Year","High","Low","End",""],a=document.createElement("table");a.id=e;var i=document.createElement("tr");for(let e=0;e<n.length;++e){var r=document.createElement("th");if(r.id=n[e].toLowerCase()+"-th",r.classList.add("rankth"),r.appendChild(document.createTextNode(n[e])),e<=n.length-2){var s=document.createElement("img");s.src="./images/icons/invisible.svg",s.classList.add("th-icon"),s.id="visibility-"+n[e].toLowerCase(),s.alt=n[e].toLowerCase()+"-visibility-icon",r.appendChild(s)}i.appendChild(r)}a.appendChild(i);var o=document.createElement("div"),l=document.createElement("h3");l.textContent=t,o.appendChild(l);for(let e=0;e<player.ranking.high.length;++e){i=document.createElement("tr");var d=document.createElement("td");d.appendChild(document.createTextNode(Object.keys(player.ranking.high[e])[0])),d.classList.add("year-td");var c=document.createElement("td");c.appendChild(document.createTextNode(player.ranking.high[e][Object.keys(player.ranking.high[e])[0]])),c.classList.add("high-td");var m=document.createElement("td");m.appendChild(document.createTextNode(player.ranking.low[e][Object.keys(player.ranking.low[e])[0]])),m.classList.add("low-td");var g=document.createElement("td");g.appendChild(document.createTextNode(player.ranking.end[e][Object.keys(player.ranking.end[e])[0]])),g.classList.add("end-td"),i.appendChild(d),i.appendChild(c),i.appendChild(m),i.appendChild(g);let t=document.createElement("img");t.src="./images/icons/remove.svg",t.classList.add("remove-img"),t.alt="remove",t.addEventListener("click",function(){document.getElementById("ranking-by-year-table").deleteRow(this.parentElement.rowIndex),loadRankingChart(),saveRankingToLocalStorage()}),i.appendChild(t),a.appendChild(i)}return[a,o]}function insertRankingRow(){var e=document.getElementById("ranking-by-year-table"),t=document.createElement("tr"),n=document.createElement("td");n.innerHTML="YYYY",n.classList.add("year-td");var a=document.createElement("td");a.innerHTML="0",a.classList.add("high-td");var i=document.createElement("td");i.innerHTML="0",i.classList.add("low-td");var r=document.createElement("td");r.innerHTML="0",r.classList.add("end-td");var s=document.createElement("img");s.className="remove-img",s.src="./images/icons/remove.svg",s.addEventListener("click",function(){document.getElementById("ranking-by-year-table").deleteRow(this.parentElement.rowIndex),loadRankingChart(),saveRankingToLocalStorage()}),t.appendChild(n),t.appendChild(a),t.appendChild(i),t.appendChild(r),t.appendChild(s),e.appendChild(t)}function getBase64Image(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t.toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/,"")}function loadMainTitle(){null!=localStorage.getItem("maintitle")?document.getElementById("maintitle").innerHTML=localStorage.getItem("maintitle"):document.getElementById("maintitle").innerHTML="Enter Name Here"}function keepNavBar(){let e=document.getElementById("navbar"),t=e.offsetTop;window.pageYOffset>=t?e.classList.add("sticky"):e.classList.remove("sticky")}function addSortingEventListeners(){Array.from(document.getElementsByClassName("rankth")).forEach(e=>{e.addEventListener("click",sortTable.bind(null,"ranking-by-year-table",{year:0,high:1,low:2,end:3}[e.id.substring(0,e.id.lastIndexOf("-"))]))})}function sortTable(e,t){let n,a,i,r,s,o,l,d,c=0;n=document.getElementById(e),i=!0,d="asc";try{for(;i;){for(i=!1,a=n.rows,r=1;r<a.length-1;++r)if(l=!1,s=a[r].getElementsByTagName("td")[t],o=a[r+1].getElementsByTagName("td")[t],"asc"==d){if(parseInt(s.innerHTML)>parseInt(o.innerHTML)){l=!0;break}}else if("desc"==d&&parseInt(s.innerHTML)<parseInt(o.innerHTML)){l=!0;break}l?(a[r].parentNode.insertBefore(a[r+1],a[r]),i=!0,++c):0==c&&"asc"==d&&(d="desc",i=!0)}}catch(e){}}function addVisibilityEventListeners(){Array.from(document.getElementsByClassName("th-icon")).forEach(e=>{var t=e.id.substring(e.id.lastIndexOf("-")+1);e.addEventListener("click",function(e){e.stopPropagation(),this.getAttribute("src").includes("invisible")?this.setAttribute("src",this.getAttribute("src").replace("invisible","visible")):this.setAttribute("src",this.getAttribute("src").replace("visible","invisible"));let n=document.getElementsByClassName(t+"-td");for(let e=0;e<n.length;++e)"collapse"==n[e].style.visibility?n[e].style.visibility="visible":n[e].style.visibility="collapse"})})}function loadRankingChart(){am4core.disposeAllCharts(),am4core.ready(function(){am4core.useTheme(am4themes_animated);var e=am4core.create("chartdiv",am4charts.XYChart);e.responsive.enabled=!0;var t=[];for(let e=0;e<player.ranking.high.length;++e)t[e]={year:Object.keys(player.ranking.high[e])[0],high:player.ranking.high[e][Object.keys(player.ranking.high[e])[0]],low:player.ranking.low[e][Object.keys(player.ranking.low[e])[0]],end:player.ranking.end[e][Object.keys(player.ranking.end[e])[0]]};e.data=t,e.scrollbarY=new am4core.Scrollbar,e.legend=new am4charts.Legend,e.legend.labels.template.fill=am4core.color("#fff"),e.legend.valueLabels.template.fill=am4core.color("#fff");var n=e.yAxes.push(new am4charts.CategoryAxis);function a(t,n){var a=e.series.push(new am4charts.ColumnSeries);a.dataFields.valueX=t,a.dataFields.categoryY="year",a.name=n,a.columns.template.tooltipText="{name}: [bold]{valueX}[/]",a.columns.template.height=am4core.percent(100),a.sequencedInterpolation=!0}n.dataFields.category="year",n.numberFormatter.numberFormat="#",n.renderer.inversed=!0,n.renderer.grid.template.location=0,n.renderer.cellStartLocation=.1,n.renderer.cellEndLocation=.9,n.renderer.labels.template.fill=am4core.color("#fff"),e.xAxes.push(new am4charts.ValueAxis).renderer.labels.template.fill=am4core.color("#fff"),a("high","High"),a("low","Low"),a("end","End")})}function addEventListenerToMainTitle(){var e=document.getElementById("maintitle");e.addEventListener("dblclick",function(e){this.contentEditable=!0}),e.addEventListener("contextmenu",function(e){e.preventDefault(),this.contentEditable=!0}),e.addEventListener("keypress",function(e){"Enter"===e.key&&(saveDataToLocalStorage(this),this.contentEditable=!1)}),e.addEventListener("focusout",function(e){saveDataToLocalStorage(this),this.contentEditable=!1})}function saveDataToLocalStorage(e){document.getElementById("stats-table-singles-service").contains(e)?(player.statistics.singlesServiceRecord.set(e.id,e.textContent),localStorage.singlesServiceRecord=JSON.stringify(Array.from(player.statistics.singlesServiceRecord.entries()))):document.getElementById("stats-table-singles-return").contains(e)?(player.statistics.singlesReturnRecord.set(e.id,e.textContent),localStorage.singlesReturnRecord=JSON.stringify(Array.from(player.statistics.singlesReturnRecord.entries()))):document.getElementById("ranking-by-year-table").contains(e)?saveRankingToLocalStorage():localStorage.setItem(e.id,e.textContent)}function saveRankingToLocalStorage(){for(var e,t=document.getElementById("ranking-by-year-table"),n=[],a=[],i=[],r=1;e=t.rows[r];++r){let t=e.cells[1].innerHTML,r=e.cells[2].innerHTML,o=e.cells[3].innerHTML;var s=e.cells[0].innerHTML;n.push({[s]:t}),a.push({[s]:r}),i.push({[s]:o})}player.ranking=new Ranking(n,a,i),localStorage.setItem("high",JSON.stringify(player.ranking.high)),localStorage.setItem("end",JSON.stringify(player.ranking.end)),localStorage.setItem("low",JSON.stringify(player.ranking.low))}function setAutomaticCalculations(){player.statistics.complementaryService.forEach((e,t)=>{document.getElementById(t).addEventListener("input",function(n){player.statistics.singlesServiceRecord.set(e,100-parseInt(document.getElementById(t).textContent)),document.getElementById(e).innerHTML=100-parseInt(document.getElementById(t).textContent),isNaN(parseInt(document.getElementById(e).textContent))&&(document.getElementById(e).innerHTML=0)}),document.getElementById(e).addEventListener("input",function(n){isNaN(parseInt(document.getElementById(t).textContent))?document.getElementById(t).innerHTML=0:(player.statistics.singlesServiceRecord.set(t,100-parseInt(document.getElementById(e).textContent)),document.getElementById(t).innerHTML=100-parseInt(document.getElementById(e).textContent))})}),player.statistics.complementaryReturn.forEach((e,t)=>{document.getElementById(t).addEventListener("input",function(n){player.statistics.singlesReturnRecord.set(e,100-parseInt(document.getElementById(t).textContent)),document.getElementById(e).innerHTML=100-parseInt(document.getElementById(t).textContent),isNaN(parseInt(document.getElementById(e).textContent))&&(document.getElementById(e).innerHTML=0)}),document.getElementById(e).addEventListener("input",function(n){isNaN(parseInt(document.getElementById(t).textContent))?document.getElementById(t).innerHTML=0:(player.statistics.singlesReturnRecord.set(t,100-parseInt(document.getElementById(e).textContent)),document.getElementById(t).innerHTML=100-parseInt(document.getElementById(e).textContent))})}),document.getElementById("Break Points Saved (Cardinal)").addEventListener("input",function(e){player.statistics.singlesServiceRecord.set("Break Points Saved (Cardinal)",parseInt(document.getElementById("Break Points Saved (%)").textContent)*parseInt(document.getElementById("Break Points Faced").textContent)),document.getElementById("Break Points Saved (%)").innerHTML=parseInt(document.getElementById("Break Points Saved (%)").textContent)*parseInt(document.getElementById("Break Points Faced").textContent)}),document.getElementById("Break Points Lost (Cardinal)").addEventListener("input",function(e){player.statistics.singlesServiceRecord.set("Break Points Lost (Cardinal)",parseInt(document.getElementById("Break Points Lost (%)").textContent)*parseInt(document.getElementById("Break Points Faced").textContent)),document.getElementById("Break Points Lost (Cardinal)").innerHTML=parseInt(document.getElementById("Break Points Lost (%)").textContent)*parseInt(document.getElementById("Break Points Faced").textContent)}),document.getElementById("Date of Birth").addEventListener("input",function(e){try{document.getElementById("Age").innerHTML=parseInt((new Date).getFullYear()-new Date(this.textContent).getFullYear())}catch(e){}})}function addEventListenersToTds(){for(var e=document.querySelectorAll("td"),t=0;t<e.length;++t)e[t].addEventListener("keypress",function(e){"Enter"===e.key&&(saveDataToLocalStorage(this),this.contentEditable=!1,document.getElementById("ranking-by-year-table").contains(this)&&loadRankingChart())}),e[t].addEventListener("focusout",function(e){saveDataToLocalStorage(this),this.contentEditable=!1,document.getElementById("ranking-by-year-table").contains(this)&&loadRankingChart()}),e[t].addEventListener("dblclick",function(e){0==this.getElementsByTagName("img").length&&(this.contentEditable=!0)}),e[t].addEventListener("contextmenu",function(e){e.preventDefault(),0==this.getElementsByTagName("img").length&&(this.contentEditable=!0)})}function addEventListenersToSocialMedia(){for(const e of["facebook","instagram","twitter"])document.getElementById(e).addEventListener("contextmenu",function(t){t.preventDefault();var n=prompt("Enter Player's "+this.id[0].toUpperCase()+this.id.slice(1)+" Link:","");document.getElementById(e+"-target").href=n}),document.getElementById(e).addEventListener("keypress",function(t){var n=prompt("Enter Player's "+this.id[0].toUpperCase()+this.id.slice(1)+" Link:","");document.getElementById(e+"-target").href=n})}window.addEventListener("load",function(){if(null==localStorage.getItem("playerImg"))document.getElementById("imginput").addEventListener("change",function(){if(this.files&&this.files[0]){var e=document.getElementById("playerimg");e.addEventListener("load",()=>{document.getElementById("imginput").style="display: none";var t=getBase64Image(e);localStorage.setItem("playerImg",t)}),e.src=URL.createObjectURL(this.files[0])}});else{document.getElementById("imginput").style="display: none";var e=localStorage.getItem("playerImg");document.getElementById("playerimg").src="data:image/png;base64,"+e}}),window.addEventListener("load",loadMainTitle),window.addEventListener("load",displayPlayerInfo),window.addEventListener("load",displayPlayerStatistics),window.addEventListener("load",displayPlayerRanking),window.addEventListener("load",addSortingEventListeners),window.addEventListener("load",addVisibilityEventListeners),window.addEventListener("load",loadRankingChart),window.addEventListener("load",addEventListenersToTds),window.addEventListener("load",addEventListenerToMainTitle),window.addEventListener("load",setAutomaticCalculations),window.addEventListener("load",addEventListenersToSocialMedia),window.addEventListener("scroll",keepNavBar),Array.from(document.getElementsByClassName("navbtn")).forEach(e=>{e.addEventListener("click",function(t){let n=document.getElementsByClassName("navbtn");for(let e=0;e<n.length;++e)n[e].classList.contains("active")&&n[e].classList.toggle("active");document.getElementById(e.id).classList.add("active")})});